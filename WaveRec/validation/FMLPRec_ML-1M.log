2025-02-17 08:03:53,963 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='FMLPRec_ML-1M', num_items=10, num_users=6041, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='FMLPRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/FMLPRec_ML-1M.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-02-17 08:03:53,976 - FMLPRecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): FMLPRecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x FMLPRecBlock(
        (layer): FMLPRecLayer(
          (out_dropout): Dropout(p=0.5, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-02-17 08:03:55,005 - Total Parameters: 295360
2025-02-17 08:04:06,322 - {'epoch': 0, 'rec_loss': '1.0260'}
2025-02-17 08:04:07,422 - {'Epoch': 0, 'HR@1': '0.0149', 'HR@5': '0.0561', 'NDCG@5': '0.0351', 'HR@10': '0.1030', 'NDCG@10': '0.0501'}
2025-02-17 08:04:07,423 - Validation score increased.  Saving model ...
2025-02-17 08:04:17,528 - {'epoch': 1, 'rec_loss': '0.8037'}
2025-02-17 08:04:18,521 - {'Epoch': 1, 'HR@1': '0.0240', 'HR@5': '0.0929', 'NDCG@5': '0.0582', 'HR@10': '0.1507', 'NDCG@10': '0.0768'}
2025-02-17 08:04:18,522 - Validation score increased.  Saving model ...
2025-02-17 08:04:28,824 - {'epoch': 2, 'rec_loss': '0.7251'}
2025-02-17 08:04:29,851 - {'Epoch': 2, 'HR@1': '0.0313', 'HR@5': '0.1076', 'NDCG@5': '0.0691', 'HR@10': '0.1714', 'NDCG@10': '0.0896'}
2025-02-17 08:04:29,852 - Validation score increased.  Saving model ...
2025-02-17 08:04:39,724 - {'epoch': 3, 'rec_loss': '0.6828'}
2025-02-17 08:04:40,735 - {'Epoch': 3, 'HR@1': '0.0315', 'HR@5': '0.1161', 'NDCG@5': '0.0736', 'HR@10': '0.1825', 'NDCG@10': '0.0950'}
2025-02-17 08:04:40,736 - Validation score increased.  Saving model ...
2025-02-17 08:04:50,800 - {'epoch': 4, 'rec_loss': '0.6539'}
2025-02-17 08:04:51,816 - {'Epoch': 4, 'HR@1': '0.0288', 'HR@5': '0.1106', 'NDCG@5': '0.0693', 'HR@10': '0.1879', 'NDCG@10': '0.0939'}
2025-02-17 08:04:51,817 - EarlyStopping counter: 1 out of 10
2025-02-17 08:05:01,957 - {'epoch': 5, 'rec_loss': '0.6352'}
2025-02-17 08:05:02,996 - {'Epoch': 5, 'HR@1': '0.0320', 'HR@5': '0.1142', 'NDCG@5': '0.0727', 'HR@10': '0.1879', 'NDCG@10': '0.0964'}
2025-02-17 08:05:02,997 - Validation score increased.  Saving model ...
2025-02-17 08:05:13,104 - {'epoch': 6, 'rec_loss': '0.6227'}
2025-02-17 08:05:14,136 - {'Epoch': 6, 'HR@1': '0.0318', 'HR@5': '0.1253', 'NDCG@5': '0.0784', 'HR@10': '0.2040', 'NDCG@10': '0.1038'}
2025-02-17 08:05:14,137 - Validation score increased.  Saving model ...
2025-02-17 08:05:24,347 - {'epoch': 7, 'rec_loss': '0.6077'}
2025-02-17 08:05:25,432 - {'Epoch': 7, 'HR@1': '0.0281', 'HR@5': '0.1194', 'NDCG@5': '0.0739', 'HR@10': '0.2008', 'NDCG@10': '0.1000'}
2025-02-17 08:05:25,433 - EarlyStopping counter: 1 out of 10
2025-02-17 08:05:35,777 - {'epoch': 8, 'rec_loss': '0.6005'}
2025-02-17 08:05:36,779 - {'Epoch': 8, 'HR@1': '0.0310', 'HR@5': '0.1207', 'NDCG@5': '0.0757', 'HR@10': '0.1990', 'NDCG@10': '0.1010'}
2025-02-17 08:05:36,780 - EarlyStopping counter: 2 out of 10
2025-02-17 08:05:46,942 - {'epoch': 9, 'rec_loss': '0.5928'}
2025-02-17 08:05:47,996 - {'Epoch': 9, 'HR@1': '0.0341', 'HR@5': '0.1243', 'NDCG@5': '0.0792', 'HR@10': '0.2058', 'NDCG@10': '0.1055'}
2025-02-17 08:05:48,001 - Validation score increased.  Saving model ...
2025-02-17 08:05:58,164 - {'epoch': 10, 'rec_loss': '0.5876'}
2025-02-17 08:05:59,163 - {'Epoch': 10, 'HR@1': '0.0315', 'HR@5': '0.1230', 'NDCG@5': '0.0772', 'HR@10': '0.2035', 'NDCG@10': '0.1029'}
2025-02-17 08:05:59,163 - EarlyStopping counter: 1 out of 10
2025-02-17 08:06:08,940 - {'epoch': 11, 'rec_loss': '0.5817'}
2025-02-17 08:06:09,950 - {'Epoch': 11, 'HR@1': '0.0334', 'HR@5': '0.1298', 'NDCG@5': '0.0817', 'HR@10': '0.2127', 'NDCG@10': '0.1084'}
2025-02-17 08:06:09,951 - Validation score increased.  Saving model ...
2025-02-17 08:06:19,808 - {'epoch': 12, 'rec_loss': '0.5773'}
2025-02-17 08:06:20,732 - {'Epoch': 12, 'HR@1': '0.0338', 'HR@5': '0.1295', 'NDCG@5': '0.0812', 'HR@10': '0.2142', 'NDCG@10': '0.1085'}
2025-02-17 08:06:20,733 - Validation score increased.  Saving model ...
2025-02-17 08:06:30,751 - {'epoch': 13, 'rec_loss': '0.5716'}
2025-02-17 08:06:31,697 - {'Epoch': 13, 'HR@1': '0.0306', 'HR@5': '0.1311', 'NDCG@5': '0.0808', 'HR@10': '0.2132', 'NDCG@10': '0.1073'}
2025-02-17 08:06:31,698 - EarlyStopping counter: 1 out of 10
2025-02-17 08:06:41,643 - {'epoch': 14, 'rec_loss': '0.5692'}
2025-02-17 08:06:42,640 - {'Epoch': 14, 'HR@1': '0.0315', 'HR@5': '0.1247', 'NDCG@5': '0.0773', 'HR@10': '0.2078', 'NDCG@10': '0.1040'}
2025-02-17 08:06:42,641 - EarlyStopping counter: 2 out of 10
2025-02-17 08:06:52,783 - {'epoch': 15, 'rec_loss': '0.5657'}
2025-02-17 08:06:53,775 - {'Epoch': 15, 'HR@1': '0.0320', 'HR@5': '0.1262', 'NDCG@5': '0.0788', 'HR@10': '0.2073', 'NDCG@10': '0.1049'}
2025-02-17 08:06:53,776 - EarlyStopping counter: 3 out of 10
2025-02-17 08:07:03,581 - {'epoch': 16, 'rec_loss': '0.5612'}
2025-02-17 08:07:04,592 - {'Epoch': 16, 'HR@1': '0.0295', 'HR@5': '0.1238', 'NDCG@5': '0.0764', 'HR@10': '0.2086', 'NDCG@10': '0.1036'}
2025-02-17 08:07:04,593 - EarlyStopping counter: 4 out of 10
2025-02-17 08:07:15,131 - {'epoch': 17, 'rec_loss': '0.5599'}
2025-02-17 08:07:16,135 - {'Epoch': 17, 'HR@1': '0.0341', 'HR@5': '0.1278', 'NDCG@5': '0.0812', 'HR@10': '0.2161', 'NDCG@10': '0.1096'}
2025-02-17 08:07:16,136 - Validation score increased.  Saving model ...
2025-02-17 08:07:26,035 - {'epoch': 18, 'rec_loss': '0.5575'}
2025-02-17 08:07:26,968 - {'Epoch': 18, 'HR@1': '0.0331', 'HR@5': '0.1300', 'NDCG@5': '0.0815', 'HR@10': '0.2195', 'NDCG@10': '0.1102'}
2025-02-17 08:07:26,969 - Validation score increased.  Saving model ...
2025-02-17 08:07:37,014 - {'epoch': 19, 'rec_loss': '0.5528'}
2025-02-17 08:07:38,005 - {'Epoch': 19, 'HR@1': '0.0336', 'HR@5': '0.1253', 'NDCG@5': '0.0797', 'HR@10': '0.2127', 'NDCG@10': '0.1078'}
2025-02-17 08:07:38,006 - EarlyStopping counter: 1 out of 10
2025-02-17 08:07:48,039 - {'epoch': 20, 'rec_loss': '0.5525'}
2025-02-17 08:07:48,953 - {'Epoch': 20, 'HR@1': '0.0290', 'HR@5': '0.1263', 'NDCG@5': '0.0781', 'HR@10': '0.2180', 'NDCG@10': '0.1076'}
2025-02-17 08:07:48,954 - EarlyStopping counter: 2 out of 10
2025-02-17 08:07:58,949 - {'epoch': 21, 'rec_loss': '0.5496'}
2025-02-17 08:07:59,876 - {'Epoch': 21, 'HR@1': '0.0331', 'HR@5': '0.1272', 'NDCG@5': '0.0800', 'HR@10': '0.2048', 'NDCG@10': '0.1048'}
2025-02-17 08:07:59,876 - EarlyStopping counter: 3 out of 10
2025-02-17 08:08:09,869 - {'epoch': 22, 'rec_loss': '0.5474'}
2025-02-17 08:08:10,881 - {'Epoch': 22, 'HR@1': '0.0371', 'HR@5': '0.1321', 'NDCG@5': '0.0843', 'HR@10': '0.2147', 'NDCG@10': '0.1109'}
2025-02-17 08:08:10,882 - Validation score increased.  Saving model ...
2025-02-17 08:08:20,906 - {'epoch': 23, 'rec_loss': '0.5472'}
2025-02-17 08:08:21,861 - {'Epoch': 23, 'HR@1': '0.0329', 'HR@5': '0.1306', 'NDCG@5': '0.0814', 'HR@10': '0.2152', 'NDCG@10': '0.1085'}
2025-02-17 08:08:21,862 - EarlyStopping counter: 1 out of 10
2025-02-17 08:08:31,881 - {'epoch': 24, 'rec_loss': '0.5412'}
2025-02-17 08:08:32,868 - {'Epoch': 24, 'HR@1': '0.0369', 'HR@5': '0.1303', 'NDCG@5': '0.0833', 'HR@10': '0.2179', 'NDCG@10': '0.1114'}
2025-02-17 08:08:32,869 - Validation score increased.  Saving model ...
2025-02-17 08:08:42,884 - {'epoch': 25, 'rec_loss': '0.5422'}
2025-02-17 08:08:43,832 - {'Epoch': 25, 'HR@1': '0.0331', 'HR@5': '0.1280', 'NDCG@5': '0.0801', 'HR@10': '0.2091', 'NDCG@10': '0.1063'}
2025-02-17 08:08:43,833 - EarlyStopping counter: 1 out of 10
2025-02-17 08:08:53,866 - {'epoch': 26, 'rec_loss': '0.5393'}
2025-02-17 08:08:54,889 - {'Epoch': 26, 'HR@1': '0.0382', 'HR@5': '0.1406', 'NDCG@5': '0.0893', 'HR@10': '0.2187', 'NDCG@10': '0.1145'}
2025-02-17 08:08:54,891 - Validation score increased.  Saving model ...
2025-02-17 08:09:05,059 - {'epoch': 27, 'rec_loss': '0.5395'}
2025-02-17 08:09:06,152 - {'Epoch': 27, 'HR@1': '0.0334', 'HR@5': '0.1315', 'NDCG@5': '0.0826', 'HR@10': '0.2169', 'NDCG@10': '0.1099'}
2025-02-17 08:09:06,153 - EarlyStopping counter: 1 out of 10
2025-02-17 08:09:16,273 - {'epoch': 28, 'rec_loss': '0.5348'}
2025-02-17 08:09:17,265 - {'Epoch': 28, 'HR@1': '0.0359', 'HR@5': '0.1280', 'NDCG@5': '0.0820', 'HR@10': '0.2094', 'NDCG@10': '0.1083'}
2025-02-17 08:09:17,266 - EarlyStopping counter: 2 out of 10
2025-02-17 08:09:27,442 - {'epoch': 29, 'rec_loss': '0.5345'}
2025-02-17 08:09:28,496 - {'Epoch': 29, 'HR@1': '0.0397', 'HR@5': '0.1339', 'NDCG@5': '0.0868', 'HR@10': '0.2225', 'NDCG@10': '0.1152'}
2025-02-17 08:09:28,497 - Validation score increased.  Saving model ...
2025-02-17 08:09:38,639 - {'epoch': 30, 'rec_loss': '0.5338'}
2025-02-17 08:09:39,738 - {'Epoch': 30, 'HR@1': '0.0339', 'HR@5': '0.1325', 'NDCG@5': '0.0825', 'HR@10': '0.2152', 'NDCG@10': '0.1091'}
2025-02-17 08:09:39,739 - EarlyStopping counter: 1 out of 10
2025-02-17 08:09:49,785 - {'epoch': 31, 'rec_loss': '0.5321'}
2025-02-17 08:09:50,859 - {'Epoch': 31, 'HR@1': '0.0374', 'HR@5': '0.1416', 'NDCG@5': '0.0886', 'HR@10': '0.2240', 'NDCG@10': '0.1149'}
2025-02-17 08:09:50,860 - EarlyStopping counter: 2 out of 10
2025-02-17 08:10:00,956 - {'epoch': 32, 'rec_loss': '0.5312'}
2025-02-17 08:10:01,914 - {'Epoch': 32, 'HR@1': '0.0326', 'HR@5': '0.1273', 'NDCG@5': '0.0798', 'HR@10': '0.2220', 'NDCG@10': '0.1103'}
2025-02-17 08:10:01,915 - EarlyStopping counter: 3 out of 10
2025-02-17 08:10:12,401 - {'epoch': 33, 'rec_loss': '0.5292'}
2025-02-17 08:10:13,378 - {'Epoch': 33, 'HR@1': '0.0334', 'HR@5': '0.1273', 'NDCG@5': '0.0803', 'HR@10': '0.2104', 'NDCG@10': '0.1070'}
2025-02-17 08:10:13,379 - EarlyStopping counter: 4 out of 10
2025-02-17 08:10:23,566 - {'epoch': 34, 'rec_loss': '0.5276'}
2025-02-17 08:10:24,555 - {'Epoch': 34, 'HR@1': '0.0329', 'HR@5': '0.1298', 'NDCG@5': '0.0815', 'HR@10': '0.2099', 'NDCG@10': '0.1071'}
2025-02-17 08:10:24,556 - EarlyStopping counter: 5 out of 10
2025-02-17 08:10:34,839 - {'epoch': 35, 'rec_loss': '0.5261'}
2025-02-17 08:10:35,822 - {'Epoch': 35, 'HR@1': '0.0348', 'HR@5': '0.1298', 'NDCG@5': '0.0815', 'HR@10': '0.2224', 'NDCG@10': '0.1111'}
2025-02-17 08:10:35,823 - EarlyStopping counter: 6 out of 10
2025-02-17 08:10:46,179 - {'epoch': 36, 'rec_loss': '0.5257'}
2025-02-17 08:10:47,141 - {'Epoch': 36, 'HR@1': '0.0316', 'HR@5': '0.1242', 'NDCG@5': '0.0765', 'HR@10': '0.2119', 'NDCG@10': '0.1047'}
2025-02-17 08:10:47,142 - EarlyStopping counter: 7 out of 10
2025-02-17 08:10:57,721 - {'epoch': 37, 'rec_loss': '0.5280'}
2025-02-17 08:10:58,648 - {'Epoch': 37, 'HR@1': '0.0338', 'HR@5': '0.1328', 'NDCG@5': '0.0834', 'HR@10': '0.2209', 'NDCG@10': '0.1116'}
2025-02-17 08:10:58,649 - EarlyStopping counter: 8 out of 10
2025-02-17 08:11:08,638 - {'epoch': 38, 'rec_loss': '0.5262'}
2025-02-17 08:11:09,633 - {'Epoch': 38, 'HR@1': '0.0346', 'HR@5': '0.1316', 'NDCG@5': '0.0830', 'HR@10': '0.2190', 'NDCG@10': '0.1111'}
2025-02-17 08:11:09,633 - EarlyStopping counter: 9 out of 10
2025-02-17 08:11:20,054 - {'epoch': 39, 'rec_loss': '0.5241'}
2025-02-17 08:11:20,964 - {'Epoch': 39, 'HR@1': '0.0349', 'HR@5': '0.1326', 'NDCG@5': '0.0841', 'HR@10': '0.2172', 'NDCG@10': '0.1110'}
2025-02-17 08:11:20,965 - EarlyStopping counter: 10 out of 10
2025-02-17 08:11:20,965 - Early stopping
2025-02-17 08:11:20,965 - ---------------Test Score---------------
2025-02-17 08:11:22,047 - {'Epoch': 0, 'HR@1': '0.0382', 'HR@5': '0.1316', 'NDCG@5': '0.0855', 'HR@10': '0.2101', 'NDCG@10': '0.1108'}
2025-02-17 08:11:22,048 - FMLPRec_wave_ML-1M
2025-02-17 08:11:22,049 - {'Epoch': 0, 'HR@1': '0.0382', 'HR@5': '0.1316', 'NDCG@5': '0.0855', 'HR@10': '0.2101', 'NDCG@10': '0.1108'}
